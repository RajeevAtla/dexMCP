name: test

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@master
      with:
        fetch-depth: 0
        submodules: recursive

    - name: Set up uv
      uses: astral-sh/setup-uv@v7
      with:
        python-version: "3.13"
        activate-environment: "true"
        enable-cache: "true"
        restore-cache: "true"
        save-cache: "true"
        cache-python: "true"

    - name: Install dependencies
      run: uv sync --group test

    - name: Run tests
      run: uv run pytest
